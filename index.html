<!doctype html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI Fit Room - Web</title>
    <style>
        :root {
            color-scheme: light dark;
        }

        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            margin: 0;
        }

        header {
            padding: 12px 16px;
            font-weight: 600;
            border-bottom: 1px solid #ccc;
        }

        main {
            max-width: 800px;
            padding: 12px 16px;
            display: grid;
            gap: 12px;
        }

        .box {
            padding: 12px;
            border: 1px solid #8884;
            border-radius: 8px;
            background: #fff2;
        }

        .muted {
            color: #666;
            font-size: 12px;
        }

        textarea {
            width: 100%;
            min-height: 96px;
            resize: vertical;
        }

        button {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #8884;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <header>AI Fit Room（Web 版）</header>
    <main>
        <section id="image-upload-wrap" class="box">
            <div class="muted">基底圖片上傳與預覽</div>
            <div id="image-upload-inner">
                <input id="image-input" type="file" accept="image/*" />
                <div id="image-preview-wrap" style="display:none; margin-top:8px;">
                    <div style="display:grid; grid-template-columns: 96px 1fr; gap:12px; align-items:start;">
                        <img id="image-preview" alt="預覽"
                            style="width:96px; height:auto; border-radius:6px; border:1px solid #8884;" />
                        <div style="display:grid; gap:8px;">
                            <div class="muted" id="image-meta"></div>
                            <div style="display:flex; gap:8px; flex-wrap: wrap;">
                                <button id="paste-image">從剪貼簿貼上圖片</button>
                                <button id="clear-image">清除圖片</button>
                            </div>
                            <div class="muted">提示：在此面板按 Cmd/Ctrl+V 也可直接貼上圖片</div>
                        </div>
                    </div>
                </div>
            </div>

        </section>

        <section id="context-imported-section" class="box" style="display: block !important;">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:wrap;">
                <div class="muted">覆蓋圖上傳與預覽（可多張）</div>
                <div style="display:flex; gap:8px; align-items:center;">
                    <button id="clear-context-all">清除全部</button>
                    <button id="choose-overlay">新增覆蓋圖</button>
                    <input id="overlay-file" type="file" accept="image/*" style="display:none;" />
                </div>
            </div>
            <div id="context-list" style="display:grid; gap:10px; margin-top:10px;"></div>
        </section>

        <section class="box">
            <div style="display:grid; gap:8px;">
                <label>情境模板
                    <select id="prompt-preset" style="width:100%;">
                        <option value="custom">自訂（不套用模板）</option>
                    </select>
                </label>
                <label>提示詞（Prompt）
                    <textarea id="compose-prompt" placeholder="請將右鍵圖片自然合成到基底上，保持真實感與光影一致。"
                        style="width:100%; min-height: 64px;"></textarea>
                </label>
                <button id="compose-btn">合成圖片</button>
            </div>
        </section>

        <section class="box">
            <div id="compose-status" class="muted"></div>
            <img id="compose-result" alt="合成結果"
                style="display:none; max-width:100%; height:auto; border-radius:6px; border:1px solid #8884;" />
            <div id="compose-actions" style="display:none; gap:8px; margin-top:8px;">
                <button id="copy-compose-base64">下載圖片</button>
                <button id="copy-compose-image">複製圖片</button>
            </div>
        </section>

        <section id="compose-section" class="box">
            <div class="muted">合成（Google AI 後端）</div>
            <div style="display:grid; gap:8px; margin-top:8px;">
                <label>API Endpoint
                    <input id="api-endpoint" type="url"
                        value="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent"
                        style="width:100%;" />
                </label>
                <label>API Key（Google Gemini）
                    <input id="api-key" type="password" placeholder="在 Google AI Studio 取得 API 金鑰"
                        style="width:100%;" />
                </label>
                <button id="save-api">儲存設定</button>
            </div>
        </section>
    </main>

    <!-- Web 專用：提供 chrome.storage 簡易 shim 與覆蓋圖上傳輔助 -->
    <script type="module" src="web/shim-chrome-storage.js"></script>
    <!-- 重用 side panel 邏輯 -->
    <script type="module" src="src/sidepanel/index.js"></script>
    <!-- Web 專用：覆蓋圖上傳（寫入 overlayImage 觸發原有流程） -->
    <script type="module" src="web/overlay-upload.js"></script>

    <script>

    </script>
</body>

</html>